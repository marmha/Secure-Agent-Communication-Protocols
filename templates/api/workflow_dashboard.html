<!DOCTYPE html>
<html>
<head>
    <title>Workflow Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background:#f5f7fa; }
        h1 { color: #222; }
        .stats { display: flex; gap: 20px; margin-bottom: 20px; }
        .card {
            background: #fff; padding: 20px; border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); flex: 1;
            text-align: center;
        }
        .recent { margin-top: 20px; }
        table { width:100%; background:white; border-radius:10px; overflow:hidden; }
        th, td { padding:10px; border-bottom:1px solid #ddd; text-align:left;}
        th { background:#4CAF50; color:white; }
        a.button {
            display:inline-block; padding:10px 15px; text-decoration:none;
            background:#4CAF50; color:white; border-radius:6px;
            margin-right:10px;
        }
        a.button:hover { background:#45a049; }
    </style>
</head>
<body>

    <h1>Workflow Dashboard</h1>

    <div class="stats">
        <div class="card">
            <h2>{{ workflow_count }}</h2>
            <p>Completed Workflows</p>
        </div>
        <div class="card">
            <h2>{{ events_count }}</h2>
            <p>Total Agent Events</p>
        </div>
    </div>

    <a href="/api/workflow/" class="button">Timeline View</a>
    <a href="/api/pipelines/" class="button">Pipeline Cards</a>

    <div class="recent">
        <h2>Recent Events</h2>
        <table>
            <tr>
                <th>Agent</th>
                <th>Timestamp</th>
                <th>Event</th>
            </tr>
            {% for log in recent_logs %}
            <tr>
                <td>{{ log.agent.name }}</td>
                <td>{{ log.timestamp|date:"d/m/Y H:i" }}</td>
                <td>{{ log.response.status|default:"-" }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3">No logs found</td></tr>
            {% endfor %}
        </table>
    </div>

</body>
</html>
